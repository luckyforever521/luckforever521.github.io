<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spring | luckforever</title><meta name="keywords" content="Spring"><meta name="author" content="刘恒运"><meta name="copyright" content="刘恒运"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. Spring框架概述  1.1 什么是Spring框架？Spring就是一个轻量级的**&#x3D;&#x3D;控制反转（IOC）和面向切面编程（AOP）&#x3D;&#x3D;**的框架。  Spring是轻量级的开源JavaEE框架 Spring可以解决企业应用开发的复杂性 Spring有两个核心部分：IOC和Aop IOC:控制反转：把创建对象过程交给Spring进行管理。不需要new的方式，Spring帮我们创建对象，进行">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring">
<meta property="og:url" content="http://example.com/2021/07/31/Spring/index.html">
<meta property="og:site_name" content="luckforever">
<meta property="og:description" content="1. Spring框架概述  1.1 什么是Spring框架？Spring就是一个轻量级的**&#x3D;&#x3D;控制反转（IOC）和面向切面编程（AOP）&#x3D;&#x3D;**的框架。  Spring是轻量级的开源JavaEE框架 Spring可以解决企业应用开发的复杂性 Spring有两个核心部分：IOC和Aop IOC:控制反转：把创建对象过程交给Spring进行管理。不需要new的方式，Spring帮我们创建对象，进行">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221506360.png">
<meta property="article:published_time" content="2021-07-31T11:00:00.000Z">
<meta property="article:modified_time" content="2021-09-09T01:12:47.267Z">
<meta property="article:author" content="刘恒运">
<meta property="article:tag" content="IOC">
<meta property="article:tag" content="AOP">
<meta property="article:tag" content="事务操作">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221506360.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2021/07/31/Spring/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-09-09 09:12:47'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"> <script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="luckforever" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/个人照片/刘恒运.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/messageboard/"><i class="fa-fw iconfont icon-liaotian-04"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li><li><a class="site-page child" href="/share/"><i class="fa-fw iconfont icon-fenxiang"></i><span> 分享</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw iconfont icon-xiangce"></i><span> 相册</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw iconfont icon-shuji"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/FilmAndTV/"><i class="fa-fw iconfont icon-yingshi1"></i><span> 影视</span></a></li><li><a class="site-page child" href="/daohang/"><i class="fa-fw iconfont icon-daohang"></i><span> 导航站</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221506360.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">luckforever</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouyex"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-zuixinwenzhang_huaban"></i><span> 找文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei1"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian1"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-shijianzhou"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-shenghuo"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/messageboard/"><i class="fa-fw iconfont icon-liaotian-04"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw iconfont icon-lianjie"></i><span> 友人帐</span></a></li><li><a class="site-page child" href="/share/"><i class="fa-fw iconfont icon-fenxiang"></i><span> 分享</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw iconfont icon-xiangce"></i><span> 相册</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw iconfont icon-shuji"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/FilmAndTV/"><i class="fa-fw iconfont icon-yingshi1"></i><span> 影视</span></a></li><li><a class="site-page child" href="/daohang/"><i class="fa-fw iconfont icon-daohang"></i><span> 导航站</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenzhongxin"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Spring</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-31T11:00:00.000Z" title="发表于 2021-07-31 19:00:00">2021-07-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-09T01:12:47.267Z" title="更新于 2021-09-09 09:12:47">2021-09-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Spring/">Spring</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Spring"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-Spring框架概述"><a href="#1-Spring框架概述" class="headerlink" title="1. Spring框架概述"></a>1. Spring框架概述</h1><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221506360.png" alt="image-20210904221506360" style="zoom: 67%;" />

<h2 id="1-1-什么是Spring框架？"><a href="#1-1-什么是Spring框架？" class="headerlink" title="1.1 什么是Spring框架？"></a>1.1 什么是Spring框架？</h2><p>Spring就是一个轻量级的**==控制反转（IOC）和面向切面编程（AOP）==**的框架。</p>
<ol>
<li>Spring是轻量级的开源JavaEE框架</li>
<li>Spring可以解决企业应用开发的复杂性</li>
<li>Spring有两个核心部分：IOC和Aop<ul>
<li><strong>IOC:控制反转：</strong>把创建对象过程交给Spring进行管理。不需要new的方式，Spring帮我们创建对象，进行对象的实例化</li>
<li><strong>Aop:面向切面：</strong>加个功能或者扩展功能，不修改源代码进行功能增强</li>
</ul>
</li>
</ol>
<h2 id="1-2-Spring框架有哪些特点？"><a href="#1-2-Spring框架有哪些特点？" class="headerlink" title="1.2 Spring框架有哪些特点？"></a>1.2 Spring框架有哪些特点？</h2><ul>
<li>方便解耦，简化开发</li>
<li>Aop编程支持</li>
<li>方便程序测试</li>
<li>方便和其他框架进行整合</li>
<li>方便进行事务操作</li>
<li>降低API开发难度</li>
</ul>
<h2 id="1-3-Spring入门"><a href="#1-3-Spring入门" class="headerlink" title="1.3 Spring入门"></a>1.3 Spring入门</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 创建普通类，在这个类中创建普通方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;、</span><br><span class="line"><span class="comment">//2.创建Spring配置文件，在配置文件配置创建的对象</span></span><br><span class="line">&lt;!--配置User对象创建--&gt;</span><br><span class="line">  &lt;bean id=<span class="string">&quot;user&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.spring.User&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line"><span class="comment">//3. 测试代码编写</span></span><br><span class="line">   <span class="comment">//1 加载Spring配置文件</span></span><br><span class="line">    ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">   <span class="comment">//2 获取配置创建的对象</span></span><br><span class="line">    User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    user.add();</span><br></pre></td></tr></table></figure>

<h1 id="2-IOC容器"><a href="#2-IOC容器" class="headerlink" title="2 IOC容器"></a>2 IOC容器</h1><h2 id="2-1-概念和底层原理"><a href="#2-1-概念和底层原理" class="headerlink" title="2.1 概念和底层原理"></a>2.1 概念和底层原理</h2><h3 id="2-1-1-什么是IOC？"><a href="#2-1-1-什么是IOC？" class="headerlink" title="2.1.1 什么是IOC？"></a>2.1.1 什么是IOC？</h3><p>（1）控制反转，把对象创建和对象之间的调用过程，交给Spring进行管理<br>（2）使用IOC目的：为了耦合度降低</p>
<p>==<strong>IOC本质：</strong>==控制反转（IOC）是一种设计思想，DI（依赖注入）是实现IOC的一种方法。控制反转是一种通过（XML或注解）并通过第三方去生产或获取特定对象的方式。</p>
<h3 id="2-1-2-IOC底层原理"><a href="#2-1-2-IOC底层原理" class="headerlink" title="2.1.2 IOC底层原理"></a>2.1.2 IOC底层原理</h3><p>（1）xml解析（获取xml里的文件配置）、工厂模式、反射（通过得到类的字节码文件然后可以操作内容所有内容）【得到class文件】</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210825212626603.png" alt="image-20210825212626603" style="zoom:80%;" />

<p> <strong>注解</strong>：Java中可以在一个类中调用另一个类的静态公方法。首先是公共方法：表示其他类是可以被访问的。调用静态公方法的语法是：类名.方法名(参数…);所以，比如另一个类叫OtherClass，它的静态公方法是 public static int MethodA() {…} 那么在你自己的类里调用的方式就是：int result = OtherClass.MethodA();另外，调用非静态公方法（也叫成员方法，比如方法叫 public int MethodB() {…}就必须先创建这个类的对象再调用其方法，例如：int result2 = new OtherClass().MethodB();<br>IOC过程</p>
<p>注解：配置xml文件，通过UserDao class的属性值反射得到class。</p>
<h3 id="2-1-3-IOC过程"><a href="#2-1-3-IOC过程" class="headerlink" title="2.1.3 IOC过程"></a>2.1.3 IOC过程</h3><p>注解：配置xml文件，通过UserDao class的属性值反射得到class。</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210825212851180.png" alt="image-20210825212851180" style="zoom:80%;" />

<h2 id="2-2-IOC容器"><a href="#2-2-IOC容器" class="headerlink" title="2.2 IOC容器"></a>2.2 IOC容器</h2><p>IOC是一个容器，IOC的思想必须要基于容器来完成，容器本质上就是对象工厂，读取配置文件，通过它用反射创建对象，本质上就是一个工厂，IOC容器底层就是一个对象工厂。</p>
<blockquote>
<p><strong>要用到IOC容器，工厂要实例化，如何让IOC容器（实例化）实现?</strong></p>
</blockquote>
<p><strong>加载配置文件，通过工厂这种过程创建对象。</strong></p>
<ul>
<li> BeanFactory：IOC容器基本实现，是Spring内部的使用接口，不提供开发人员进行使用。加载配置文件时候不会创建对象，在获取对象（使用）才去创建对象</li>
<li>ApplicationContext：BeanFactory接口的子接口，提供更多更强大的功能，一般由开发人员进行使用。加载配置文件时候就会把在配置文件对象进行创建</li>
</ul>
<blockquote>
<p><strong>ApplicationContext接口有实现类</strong></p>
</blockquote>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210825213406054.png" alt="image-20210825213406054" style="zoom:80%;" />

<h2 id="2-3-IOC的具体操作"><a href="#2-3-IOC的具体操作" class="headerlink" title="2.3 IOC的具体操作"></a>2.3 IOC的具体操作</h2><p>称作Bean管理操作。Bean管理指的是两个操作，Bean是一个对象<br>    （1）Spring创建对象：由Spring对象去操作。<br>    （2）Spirng注入属性：向username设置值。</p>
<p>Bean管理操作有两种方式<br>（1）基于xml配置文件方式实现<br>（2）基于注解方式实现</p>
<h3 id="2-3-1-基于Xml方式"><a href="#2-3-1-基于Xml方式" class="headerlink" title="2.3.1 基于Xml方式"></a>2.3.1 基于Xml方式</h3><blockquote>
<p>一、基于xml方式创建对象</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;user&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.spring.User&quot;</span>&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>（1）在spring配置文件中，使用bean标签，标签里面添加对应属性，就可以实现对象创建<br>（2）在bean标签有很多属性，介绍常用的属性<br>        id:取一个标识（不可以加特殊符号）<br>        class:类的全路径<br>        name：可以加特殊符号。<br>（3）创建对象时候，默认也是执行无参数构造方法完成对象创建。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 加载Spring配置文件</span></span><br><span class="line">   ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line"><span class="comment">//2 获取配置创建的对象</span></span><br><span class="line">    User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">   	user.add();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>二、基于xml方式注入属性</p>
</blockquote>
<p>DI：依赖注入，就是注入属性。DI是IOC中的一种实现，在创建对象的基础上实现。</p>
<p>==使用set方法进行注入==</p>
<p><strong>原始方式：</strong></p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904151640534.png" alt="image-20210904151640534" style="zoom:80%;" />

<p><strong>spring中实现：</strong></p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904151713933.png" alt="image-20210904151713933" style="zoom:80%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;book&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.spring.Book&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;bname&quot;</span> value=<span class="string">&quot;易筋经&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;bauthor&quot;</span> value=<span class="string">&quot;达摩老祖&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 加载Spring配置文件</span></span><br><span class="line">ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line"><span class="comment">//2 获取配置创建的对象</span></span><br><span class="line">Book book = context.getBean(<span class="string">&quot;book&quot;</span>, Book.class);</span><br><span class="line">System.out.println(book);</span><br><span class="line">book.testdemo();</span><br></pre></td></tr></table></figure>

<p>==使用有参构造进行注入==</p>
<p><strong>原始方式：</strong></p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904151853728.png" alt="image-20210904151853728" style="zoom:80%;" />

<p><strong>spring中实现：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Oders</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String oname;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Oders</span><span class="params">(String oname, String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.oname = oname;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(oname+<span class="string">&quot;:&quot;</span>+address);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;order&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.spring.Oders&quot;</span>&gt;</span><br><span class="line">  &lt;constructor-arg name=<span class="string">&quot;oname&quot;</span> value=<span class="string">&quot;电脑&quot;</span>&gt;&lt;/constructor-arg&gt;</span><br><span class="line">  &lt;constructor-arg name=<span class="string">&quot;address&quot;</span> value=<span class="string">&quot;china&quot;</span>&gt;&lt;/constructor-arg&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1 加载Spring配置文件</span></span><br><span class="line">ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line"><span class="comment">//2 获取配置创建的对象</span></span><br><span class="line">Oders order = context.getBean(<span class="string">&quot;order&quot;</span>, Oders.class);</span><br><span class="line">System.out.println(order);</span><br><span class="line">order.orderTest();</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-1-P名称空间注入"><a href="#2-3-1-1-P名称空间注入" class="headerlink" title="2.3.1.1 P名称空间注入"></a>2.3.1.1 P名称空间注入</h4><p>使用p名称空间注入，可以简化基于xml配置方式第一步添加p名称空间在配置文件中</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904154105985.png" alt="image-20210904154105985" style="zoom:67%;" />

<h4 id="2-3-1-2-注入其他类型属性"><a href="#2-3-1-2-注入其他类型属性" class="headerlink" title="2.3.1.2 注入其他类型属性"></a>2.3.1.2 注入其他类型属性</h4><blockquote>
<p>注入外部Bean</p>
</blockquote>
<p>创建两个类service和dao类，在service调用dao的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span>  </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dao updata&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建UserDao类型属性，生成set方法（基本数据类型+对象类型）</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">	    userDao.update();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;userdao&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.dao.UserDaoImp&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;userservice&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.service.UserService&quot;</span>&gt;</span><br><span class="line">  	<span class="comment">//注入userDao对象（使用set进行依赖注入）</span></span><br><span class="line"><span class="comment">//name:类里面的属性名称</span></span><br><span class="line"><span class="comment">//ref：创建userDao对象Bean标签id值</span></span><br><span class="line">&lt;property name=<span class="string">&quot;userDao&quot;</span> ref=<span class="string">&quot;userdao&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context1 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">    UserService userservice = context1.getBean(<span class="string">&quot;userservice&quot;</span>, UserService.class);</span><br><span class="line">    userservice.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注入内部Bean</p>
</blockquote>
<p>（1）一对多关系：部门和员工</p>
<p>一个部门有多个员工，一个员工属于一个部门，部门是一，员工是多。</p>
<p>（2）在实体类之间表示一对多关系，员工表示所属部门，使用对象类型属性进行表示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dept</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String dname;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDname</span><span class="params">(String dname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dname = dname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Dept&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;dname=&#x27;&quot;</span> + dname + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String ename;</span><br><span class="line">    <span class="keyword">private</span> String gendetr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Dept dept;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDept</span><span class="params">(Dept dept)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dept = dept;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ename = ename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGendetr</span><span class="params">(String gendetr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gendetr = gendetr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(ename+<span class="string">&quot; &quot;</span>+gendetr+<span class="string">&quot; &quot;</span>+dept);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;emp&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.bean.Emp&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;ename&quot;</span> value=<span class="string">&quot;lucy&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;gendetr&quot;</span> value=<span class="string">&quot;女&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;dept&quot;</span> &gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;dept&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.bean.Dept&quot;</span>&gt;</span><br><span class="line">      &lt;property name=<span class="string">&quot;dname&quot;</span> value=<span class="string">&quot;保安部&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context2 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">    Emp emp = context2.getBean(<span class="string">&quot;emp&quot;</span>, Emp.class);</span><br><span class="line">    emp.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注入属性-级联赋值</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;dept1&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.bean.Dept&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;dname&quot;</span> value=<span class="string">&quot;市场部&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;emp&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.bean.Emp&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;ename&quot;</span> value=<span class="string">&quot;lucy&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;gendetr&quot;</span> value=<span class="string">&quot;女&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;dept&quot;</span> ref=<span class="string">&quot;dept1&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-3注入属性集合"><a href="#2-3-1-3注入属性集合" class="headerlink" title="2.3.1.3注入属性集合"></a>2.3.1.3注入属性集合</h4><p>1、注入数组类型属性<br>2、注入List集合类型属性<br>3、注入Map集合类型属性</p>
<p>（1）创建类，定义数组、list、map、set类型属性，生成对应set方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String[] courses;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; sets;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourses</span><span class="params">(String[] courses)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courses = courses;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMaps</span><span class="params">(Map&lt;String, String&gt; maps)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.maps = maps;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSets</span><span class="params">(Set&lt;String&gt; sets)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sets = sets;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(Arrays.toString(courses));</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(maps);</span><br><span class="line">        System.out.println(sets);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（2）在spring配置文件进行配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;stu&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.collection.Stu&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;courses&quot;</span> &gt;</span><br><span class="line">        &lt;array&gt;</span><br><span class="line">            &lt;value&gt;java课程&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;英语课程&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;数学课程&lt;/value&gt;</span><br><span class="line">        &lt;/array&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;list&quot;</span>&gt;</span><br><span class="line">        &lt;list&gt;</span><br><span class="line">            &lt;value&gt;张&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;小&lt;/value&gt;</span><br><span class="line">        &lt;/list&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;maps&quot;</span>&gt;</span><br><span class="line">        &lt;map&gt;</span><br><span class="line">            &lt;entry key=<span class="string">&quot;JAVA&quot;</span> value=<span class="string">&quot;java&quot;</span>&gt;&lt;/entry&gt;</span><br><span class="line">            &lt;entry key=<span class="string">&quot;PHP&quot;</span> value=<span class="string">&quot;php&quot;</span>&gt;&lt;/entry&gt;</span><br><span class="line">        &lt;/map&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;sets&quot;</span>&gt;</span><br><span class="line">        &lt;set&gt;</span><br><span class="line">            &lt;value&gt;Mysql&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;Redis&lt;/value&gt;</span><br><span class="line">        &lt;/set&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context3 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">    Stu stu = context3.getBean(<span class="string">&quot;stu&quot;</span>, Stu.class);</span><br><span class="line">    stu.test1();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、在集合里面设置对象类型值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String cname;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCname</span><span class="params">(String cname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cname = cname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stu</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseList</span><span class="params">(List&lt;Course&gt; courseList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseList = courseList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">                System.out.println(courseList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;course1&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.collection.Course&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;cname&quot;</span> value=<span class="string">&quot;Spring&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;course2&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.collection.Course&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;cname&quot;</span> value=<span class="string">&quot;mybatis&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;stu&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.collection.Stu&quot;</span>&gt; </span><br><span class="line">    &lt;property name=<span class="string">&quot;courseList&quot;</span>&gt;</span><br><span class="line">        &lt;list&gt;</span><br><span class="line">            &lt;ref bean=<span class="string">&quot;course1&quot;</span>&gt;&lt;/ref&gt;</span><br><span class="line">            &lt;ref bean=<span class="string">&quot;course2&quot;</span>&gt;&lt;/ref&gt;</span><br><span class="line">        &lt;/list&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>5、把集合注入部分提取出来</p>
<p>（1）在spring配置文件中引入名称空间util</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Beek</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns:util=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;util:list id=<span class="string">&quot;beeklist&quot;</span>&gt;</span><br><span class="line">        &lt;value&gt;路&lt;/value&gt;</span><br><span class="line">        &lt;value&gt;刘&lt;/value&gt;</span><br><span class="line">    &lt;/util:list&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;beek&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.collection.Beek&quot;</span>&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;list&quot;</span> ref=<span class="string">&quot;beeklist&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context4 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean3.xml&quot;</span>);</span><br><span class="line">    Beek beek = context4.getBean(<span class="string">&quot;beek&quot;</span>, Beek.class);</span><br><span class="line">    beek.test4();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-4-FactoryBean"><a href="#2-3-1-4-FactoryBean" class="headerlink" title="2.3.1.4 FactoryBean"></a>2.3.1.4 FactoryBean</h4><p>1、Spring有两种类型bean，一种普通bean，另外一种工厂bean（FactoryBean）<br>2、普通bean：在配置文件中定义bean类型就是返回类型<br>3、工厂bean：在配置文件定义bean类型可以和返回类型不一样<br>第一步创建类，让这个类作为工厂bean，实现接口FactoryBean第二步实现接口里面的方法，在实现的方法中定义返回的bean类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span>&lt;<span class="title">Course</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义返回bean</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Course <span class="title">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">     Course course =<span class="keyword">new</span> Course();</span><br><span class="line">     course.setCname(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">     <span class="keyword">return</span> course;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;mybean&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.factorybean.MyBean&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context4 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean4.xml&quot;</span>);</span><br><span class="line">    Course course = context4.getBean(<span class="string">&quot;mybean&quot;</span>, Course.class);</span><br><span class="line">    System.out.println(course);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-5-bean作用域"><a href="#2-3-1-5-bean作用域" class="headerlink" title="2.3.1.5  bean作用域"></a>2.3.1.5  bean作用域</h4><p>1、在Spring里面，设置创建bean实例是单实例还是多实例<br>2、在Spring里面，默认情况下，bean是单实例对象</p>
<p>3、如何设置单实例还是多实例<br>（1）在spring配置文件bean标签里面有属性（scope）用于设置单实例还是多实例<br>（2）scope属性值<br>    第一个值默认值，singleton，表示是单实例对象第二个值prototype，表示是多实例对象</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904182704224.png" alt="image-20210904182704224" style="zoom:80%;" />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904182721100.png" alt="image-20210904182721100" style="zoom:80%;" />

<h4 id="2-3-1-6-bean的生命周期"><a href="#2-3-1-6-bean的生命周期" class="headerlink" title="2.3.1.6 bean的生命周期"></a>2.3.1.6 bean的生命周期</h4><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904184821051.png" alt="image-20210904184821051"  />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904185242569.png" alt="image-20210904185242569" style="zoom:80%;" />

<p>（1）通过构造器创建bean实例（无参数构造）,由BeanFactory读取Bean定义文件【实例化对象】</p>
<p>（2）为bean的属性设置值和对其他bean引用（调用set方法）【依赖注入】</p>
<p>（3）把bean实例传递bean后置处理器的方法==postProcessBeforeInitialization==</p>
<p>（4）调用bean的初始化的方法（需要进行配置初始化的方法afterPropertiesSet()）（后置处理器技术，AOP基于这个技术实现）</p>
<p>（5）把bean实例传递bean后置处理器的方法==postProcessAfterInitialization==</p>
<p>（6）bean可以使用了（对象获取到了）</p>
<p>（7）当容器关闭时候，调用bean的销毁的方法（需要进行配置销毁的方法）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ooders</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ooders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第一步&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> String oname;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOname</span><span class="params">(String oname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.oname = oname;</span><br><span class="line">        System.out.println(<span class="string">&quot;第二步&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建执行初始化的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMethod</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第三步 执行初始化方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建执行销毁的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destoryMethoh</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第五步 执行销毁的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">testoders</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context4 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean4.xml&quot;</span>);</span><br><span class="line">    Ooders ooders = context4.getBean(<span class="string">&quot;ooders&quot;</span>, Ooders.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;第四步 获取创建的bean实例对象&quot;</span>);</span><br><span class="line">    System.out.println(ooders);</span><br><span class="line">    context4.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;ooders&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.aiguigu.bean.Ooders&quot;</span> init-method=<span class="string">&quot;initMethod&quot;</span> destroy-method=<span class="string">&quot;destoryMethoh&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;oname&quot;</span> value=<span class="string">&quot;手机&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-7-XML自动装配1"><a href="#2-3-1-7-XML自动装配1" class="headerlink" title="2.3.1.7  XML自动装配1"></a>2.3.1.7  XML自动装配1</h4><p>一、Xml自动装配<br>      之前操作向一个类中注入属性，在配置文件中，通过property(name value)设置属性值，叫做手动装配。<br>二、什么是自动装配<br>      根据指定装配规则（属性名称或者属性类型），Spring自动将匹配的属性值进行注入<br>三、演示自动装配的过程</p>
<p>1、根据属性名称自动装配</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904185850458.png" alt="image-20210904185850458" style="zoom: 67%;" />

<img src="1.IOC - 副本.assets/image-20210904185905167.png" alt="image-20210904185905167" style="zoom:67%;" />

<p>2、根据属性类型自动装配</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904185920535.png" alt="image-20210904185920535" style="zoom:67%;" />

<h4 id="2-3-1-8-XML自动装配2"><a href="#2-3-1-8-XML自动装配2" class="headerlink" title="2.3.1.8  XML自动装配2"></a>2.3.1.8  XML自动装配2</h4><p>自动装配是Spring满足bean依赖的一种方式，Spring会在上下文中自动寻找，并自动给bean装配属性。</p>
<p>在Spring中有三种装配方式</p>
<ol>
<li>在xml显示的配置</li>
<li>在java中显示的配置</li>
<li>隐式的自动装配bean</li>
</ol>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904190307352.png" alt="image-20210904190307352" style="zoom:80%;" />

<p><strong>ByName自动装配</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><span class="line">&lt;bean <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;！--</span><br><span class="line">byName:会自动在容器上下文中寻找，和自己对象属性值对应的bean id</span><br><span class="line">byType:会自动在容器上下文中寻找，和自己对象属性类型相同的bean </span><br><span class="line">--&gt;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904190658168.png" alt="image-20210904190658168" style="zoom:67%;" />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904190724362.png" alt="image-20210904190724362" style="zoom:80%;" />

<p>==<strong>1、共同点</strong>==</p>
<p>两者都可以写在字段和setter方法上。两者如果都写在字段上，那么就不需要再写setter方法。</p>
<p>==<strong>2、不同点</strong>==</p>
<p>（1）@Autowired</p>
<p>@Autowired为Spring提供的注解，需要导入包org.springframework.beans.factory.annotation.Autowired;只按照byType注入。</p>
<p>@Autowired注解是**==按照类型（byType）装配依赖对象==**，默认情况下它要求依赖对象必须存在，如果允许null值，可以设置它的required属性为false。如果我们想使用按照名称（byName）来装配，可以结合@Qualifier注解一起使用。</p>
<p>2）@Resource</p>
<p>@Resource**==默认按照ByName自动注入==**，由J2EE提供，需要导入包javax.annotation.Resource。@Resource有两个重要的属性：name和type，而Spring将@Resource注解的name属性解析为bean的名字，而type属性则解析为bean的类型。所以，如果使用name属性，则使用byName的自动注入策略，而使用type属性时则使用byType自动注入策略。如果既不制定name也不制定type属性，这时将通过反射机制使用byName自动注入策略。</p>
<h4 id="2-3-1-9-外部属性文件"><a href="#2-3-1-9-外部属性文件" class="headerlink" title="2.3.1.9  外部属性文件"></a>2.3.1.9  外部属性文件</h4><p>1、直接配置数据库信息</p>
<p>（1）配置德鲁伊连接池<br>（2）引入德鲁伊连接池依赖jar包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;dataSource&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span><br><span class="line">    &lt;!-- 获取properties文件内容，根据key获取，使用spring表达式获取 --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;driverClassName&quot;</span> value=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;jdbc:mysql://localhost:3306/userDb&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;root&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;lhy147258&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>2、引入外部属性文件配置数据库连接池</p>
<p>（1）创建外部属性文件，properties格式文件，写数据库信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">prop.driverClass=com.mysql.jdbc.Driver</span><br><span class="line">prop.url=jdbc:mysql:<span class="comment">//localhost:3306/userDb</span></span><br><span class="line">prop.userName=root</span><br><span class="line">prop.password=lhy147258</span><br></pre></td></tr></table></figure>

<p>（2）把外部properties属性文件引入到spring配置文件中</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904191206564.png" alt="image-20210904191206564" style="zoom:67%;" />

<p>（3）在spring配置文件使用标签引入外部属性文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:property-placeholder location=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;dataSource&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span><br><span class="line">    &lt;!-- 获取properties文件内容，根据key获取，使用spring表达式获取 --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;driverClassName&quot;</span> value=<span class="string">&quot;$&#123;prop.driverClass&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;$&#123;prop.url&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;$&#123;prop.userName&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;$&#123;prop.password&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-基于注解方式"><a href="#2-3-2-基于注解方式" class="headerlink" title="2.3.2 基于注解方式"></a>2.3.2 基于注解方式</h3><p>基于注解实现创建对象和注入属性<br>1、什么是注解<br>（1）注解是代码特殊标记，格式：@注解名称(属性名称=属性值,属性名称=属性值..)<br>（2）使用注解，注解作用在类上面，方法上面，属性上面<br>（3）使用注解目的：简化xml配置<br>2、Spring针对Bean管理中创建对象提供注解<br>（1）@Component（普通）<br>（2）@Service（业务逻辑 Service）<br>（3）@Controller(WEB)<br>（4）@Repository(DAO)<br>上面四个注解功能是一样的，都可以用来创建bean实例</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904191300905.png" alt="image-20210904191300905" style="zoom:80%;" />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904191329070.png" alt="image-20210904191329070" style="zoom:67%;" />

<h4 id="2-3-2-1-基于注解方式实现对象创建"><a href="#2-3-2-1-基于注解方式实现对象创建" class="headerlink" title="2.3.2.1 基于注解方式实现对象创建"></a>2.3.2.1 基于注解方式实现对象创建</h4><p>(1)第一步 引入依赖</p>
<p>(2)开启组件扫描</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.aiguigu&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br></pre></td></tr></table></figure>

<p>（3）创建类，在类上面添加创建对象注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span><span class="comment">// &lt;bean id=&quot;&quot; class=&quot;.class&quot; /&gt;默认值是类名称，首字母小写 userService</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context1 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">    UserService userservice = context1.getBean(<span class="string">&quot;userservice&quot;</span>, UserService.class);</span><br><span class="line">    userservice.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、开启组件扫描细节配置</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904194647885.png" alt="image-20210904194647885" style="zoom:80%;" />

<h4 id="2-3-2-2-基于注解方式实现属性注入"><a href="#2-3-2-2-基于注解方式实现属性注入" class="headerlink" title="2.3.2.2 基于注解方式实现属性注入"></a>2.3.2.2 基于注解方式实现属性注入</h4><p>一、@Autowired：根据属性类型进行自动装配（静态方法、属性不能注入）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.aiguigu&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span>  </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dao updata&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @Service (value=&quot;userService&quot;)&lt;bean id=&quot;&quot; class=&quot;.class&quot; /&gt;</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义dao类型属性（不需要添加set方法</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">        userDao.update();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context1 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">    UserService userservice = context1.getBean(<span class="string">&quot;userservice&quot;</span>, UserService.class);</span><br><span class="line">    userservice.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二、@Qualifier: 根据属性名称进行注入<br>         这个@Qualifier注解的使用，和上面@Autowired一起使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.aiguigu&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span>  </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository(value = &quot;userDaoImp1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dao updata&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @Service (value=&quot;userService&quot;)&lt;bean id=&quot;&quot; class=&quot;.class&quot; /&gt;</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义dao类型属性（不需要添加set方法</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDaoImp1&quot;)</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">        userDao.update();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>三、@Resourse： 可以根据类型注入，也可以根据名称注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span><span class="comment">//根据类型注入</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">    userDao.update();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource(name = &quot;userDaoImp1&quot;)</span><span class="comment">//根据属性注入</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;service add.......&quot;</span>);</span><br><span class="line">    userDao.update();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>四、@Value:    注入普通类型属性</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904194933728.png" alt="image-20210904194933728" style="zoom:80%;" />

<h4 id="2-3-2-3-完全注解开发"><a href="#2-3-2-3-完全注解开发" class="headerlink" title="2.3.2.3 完全注解开发"></a>2.3.2.3 完全注解开发</h4><p>（1）创建配置类，替代xml配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span><span class="comment">//作为配置类，代替xml文件</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dao add.....&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(value = &quot;userservice&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value =&quot;userDaoImp&quot; )</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service add.......&quot;</span>+name);</span><br><span class="line">        userDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（2）编写测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext context1 = <span class="keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);</span><br><span class="line">    UserService userservice = context1.getBean(<span class="string">&quot;userservice&quot;</span>, UserService.class);</span><br><span class="line">    System.out.println(userservice);</span><br><span class="line">    userservice.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-4-依赖注入的几种方式"><a href="#2-4-依赖注入的几种方式" class="headerlink" title="2.4  依赖注入的几种方式"></a>2.4  依赖注入的几种方式</h2><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904205325177.png" alt="image-20210904205325177" style="zoom:67%;" />

<blockquote>
<p>（1）手动注入</p>
</blockquote>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904205502304.png" alt="image-20210904205502304" style="zoom: 67%;" />

<blockquote>
<p>2.1  自动注入（XML）：@autowire根据set方法OrderService,然后遍历。然后把O小写。去找Bean，反射调用set()方法然后赋值。</p>
</blockquote>
<p>==set方法==:</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904205615756.png" alt="image-20210904205615756" style="zoom:67%;" />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904205625557.png" alt="image-20210904205625557" style="zoom:67%;" />

<p>==构造器方法==</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904205711020.png" alt="image-20210904205711020" style="zoom:67%;" />

<blockquote>
<p>2.2   自动注入（Autowire）</p>
</blockquote>
<ol>
<li>先去找注入点（属性和方法）</li>
<li>遍历方法和属性</li>
<li>先byType再byName</li>
</ol>
<p><strong>==普通方法：==</strong></p>
<p>（1）指的是OrderService对象</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904210106869.png" alt="image-20210904210106869" style="zoom:67%;" />

<p>（2）指的是参数</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904210143732.png" alt="image-20210904210143732" style="zoom:67%;" />

<h2 id="2-5-Autowire底层原理"><a href="#2-5-Autowire底层原理" class="headerlink" title="2.5 @Autowire底层原理"></a>2.5 @Autowire底层原理</h2><p>​        <strong>在容器启动，为对象赋值的时候，遇到@Autowired注解，会用后置处理器机制，来创建属性的实例，然后再利用反射机制，将实例化好的属性，赋值给对象上，这就是Autowired的原理。</strong></p>
<p>​        <strong>间接实现InstantiationAwareBeanPostProcessor，就具备了实例化前后(而不是初始化前后)管理对象的能力，实现了BeanPostProcessor，具有初始化前后管理对象的能力，实现BeanFactoryAware，具备随时拿到BeanFactory的能力，也就是说，这个AutowiredAnnotationBeanPostProcessor具备一切后置处理器的能力。</strong></p>
<ol>
<li>先找注入点</li>
<li>postProcessorProperties(注入点进行注入)</li>
<li>从缓存injectionMetadataCache调用inject方法进行注入</li>
</ol>
<h2 id="2-6-bean的名字"><a href="#2-6-bean的名字" class="headerlink" title="2.6 bean的名字"></a>2.6 bean的名字</h2><p>注：Spring对注解形式的bean的名字的默认处理就是将首字母小写，再拼接后面的字符。当类的名字是以两个或以上的大写字母开头的话，bean的名字会与类名保持一致</p>
<h2 id="2-7-Spring解决循环依赖"><a href="#2-7-Spring解决循环依赖" class="headerlink" title="2.7 Spring解决循环依赖"></a>2.7 Spring解决循环依赖</h2><p>Spring创建Bean的流程</p>
<p>首先需要了解是Spring它创建Bean的流程，我把它的大致调用栈绘图如下：</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904214305932.png" alt="image-20210904214305932" style="zoom:80%;" />

<p>对Bean的创建最为核心三个方法解释如下：</p>
<ul>
<li><code>createBeanInstance</code>：例化，其实也就是调用对象的<strong>构造方法</strong>实例化对象</li>
<li><code>populateBean</code>：填充属性，这一步主要是对bean的依赖属性进行注入(<code>@Autowired</code>)</li>
<li><code>initializeBean</code>：回到一些形如<code>initMethod</code>、<code>InitializingBean</code>等方法</li>
</ul>
<p>从对<code>单例Bean</code>的初始化可以看出，循环依赖主要发生在<strong>第二步（populateBean）</strong>，也就是field属性注入的处理。</p>
<ol>
<li>使用<code>context.getBean(A.class)</code>，旨在获取容器内的单例A(若A不存在，就会走A这个Bean的创建流程)，显然初次获取A是不存在的，因此走<strong>A的创建之路~</strong></li>
<li><code>实例化</code>A（注意此处仅仅是实例化），并将它放进<code>缓存</code>（此时A已经实例化完成，已经可以被引用了）</li>
<li><code>初始化</code>A：<code>@Autowired</code>依赖注入B（此时需要去容器内获取B）</li>
<li>为了完成依赖注入B，会通过<code>getBean(B)</code>去容器内找B。但此时B在容器内不存在，就走向<strong>B的创建之路~</strong></li>
<li><code>实例化</code>B，并将其放入缓存。（此时B也能够被引用了）</li>
<li><code>初始化</code>B，<code>@Autowired</code>依赖注入A（此时需要去容器内获取A）</li>
<li><code>此处重要</code>：初始化B时会调用<code>getBean(A)</code>去容器内找到A，上面我们已经说过了此时候因为A已经实例化完成了并且放进了缓存里，所以这个时候去看缓存里是已经存在A的引用了的，所以<code>getBean(A)</code>能够正常返回</li>
<li><strong>B初始化成功</strong>（此时已经注入A成功了，已成功持有A的引用了），return（注意此处return相当于是返回最上面的<code>getBean(B)</code>这句代码，回到了初始化A的流程中~）。</li>
<li>因为B实例已经成功返回了，因此最终<strong>A也初始化成功</strong></li>
<li><strong>到此，B持有的已经是初始化完成的A，A持有的也是初始化完成的B，</strong></li>
</ol>
<blockquote>
<h4 id="Spring容器的三级缓存"><a href="#Spring容器的三级缓存" class="headerlink" title="Spring容器的三级缓存"></a>Spring容器的三级缓存</h4></blockquote>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904214340639.png" alt="image-20210904214340639"  />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904214406499.png" alt="image-20210904214406499" style="zoom:80%;" />

<h2 id="2-8-Configuation总结"><a href="#2-8-Configuation总结" class="headerlink" title="2.8@Configuation总结"></a>2.8@Configuation总结</h2><p> @Configuation等价于<Beans></Beans><br> @Bean等价于<Bean></Bean><br> @ComponentScan等价于&lt;context:component-scan base-package=”com.dxz.demo”/&gt;</p>
<h1 id="3-AOP"><a href="#3-AOP" class="headerlink" title="3 AOP"></a>3 AOP</h1><h2 id="3-1-什么是AOP"><a href="#3-1-什么是AOP" class="headerlink" title="3.1 什么是AOP"></a>3.1 什么是AOP</h2><p>（1）面向切面编程（方面），利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。<br>（2）通俗描述：不通过修改源代码方式，在主干功能里面添加新功能<br>（3）使用登录例子说明AOP</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904215014195.png" alt="image-20210904215014195" style="zoom:80%;" />

<h2 id="3-2-AOP底层原理"><a href="#3-2-AOP底层原理" class="headerlink" title="3.2 AOP底层原理"></a>3.2 AOP底层原理</h2><p>（1）有两种情况动态代理</p>
<blockquote>
<h4 id="第一种有接口情况，使用JDK动态代理"><a href="#第一种有接口情况，使用JDK动态代理" class="headerlink" title="第一种有接口情况，使用JDK动态代理"></a>第一种有接口情况，使用JDK动态代理</h4></blockquote>
<p>​        创建接口实现类代理对象，增强类的方法</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904215127837.png" alt="image-20210904215127837" style="zoom:80%;" />

<blockquote>
<h4 id="第二种没有接口情况，使用CGLIB动态代理"><a href="#第二种没有接口情况，使用CGLIB动态代理" class="headerlink" title="第二种没有接口情况，使用CGLIB动态代理"></a>第二种没有接口情况，使用CGLIB动态代理</h4></blockquote>
<p>创建子类的代理对象，增强类的方法</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904215220766.png" alt="image-20210904215220766" style="zoom:80%;" />

<h2 id="3-3-JDK动态代理"><a href="#3-3-JDK动态代理" class="headerlink" title="3.3 JDK动态代理"></a>3.3 JDK动态代理</h2><p>1、使用JDK动态代理，使用Proxy类里面的方法创建代理对象</p>
<p>（1）调用newProxyInstance方法</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904215352573.png" alt="image-20210904215352573" style="zoom:80%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(String id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImp1</span> <span class="keyword">implements</span> <span class="title">UserDao1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add方法执行了&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update方法执行了&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDKProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Class[] interfaces=&#123;UserDao1.class&#125;;</span><br><span class="line">        <span class="comment">/*Proxy.newProxyInstance(JDKProxy.class.getClassLoader(), interfaces, new InvocationHandler() &#123;</span></span><br><span class="line"><span class="comment">            @Override</span></span><br><span class="line"><span class="comment">            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span></span><br><span class="line"><span class="comment">                return null;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line">        UserDaoImp1 userDaoImp1 = <span class="keyword">new</span> UserDaoImp1();</span><br><span class="line">        <span class="comment">//创建接口实现类的代理对象</span></span><br><span class="line">        UserDao1 userDao1 = (UserDao1)Proxy.newProxyInstance(JDKProxy.class.getClassLoader(), interfaces, <span class="keyword">new</span> UserDao1Proxy(userDaoImp1));</span><br><span class="line">        <span class="keyword">int</span> result = userDao1.add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//创建代理对象的代码</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">UserDao1Proxy</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">    <span class="comment">//1把创建的是谁的对象，把谁传递过来</span></span><br><span class="line">    <span class="comment">//通过参构造public UserDao1Proxy(UserDaoImp1 userDaoImp1) &#123;this.userDaoImp1=userDaoImp1;&#125;</span></span><br><span class="line">    <span class="keyword">private</span> Object obj;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDao1Proxy</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj=obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//增强的逻辑</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;方法之前&quot;</span>+method.getName()+<span class="string">&quot;传递的参数&quot;</span>+ Arrays.toString(args));</span><br><span class="line">        <span class="comment">//方法之前</span></span><br><span class="line">        Object o = method.invoke(obj, args);</span><br><span class="line">        <span class="comment">//方法之后</span></span><br><span class="line">        System.out.println(<span class="string">&quot;方法之后&quot;</span>+obj);</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904215433630.png" alt="image-20210904215433630"></p>
<h2 id="3-4-AOP术语"><a href="#3-4-AOP术语" class="headerlink" title="3.4 AOP术语"></a>3.4 AOP术语</h2><blockquote>
<h4 id="1-连接点"><a href="#1-连接点" class="headerlink" title="1. 连接点"></a>1. 连接点</h4></blockquote>
<p>类里面哪些方法可以被增强，这些方法称为连接点</p>
<blockquote>
<h4 id="2-切入点"><a href="#2-切入点" class="headerlink" title="2. 切入点"></a>2. 切入点</h4></blockquote>
<p>实际被真正增强的方法，称为切入点</p>
<blockquote>
<h4 id="3-通知"><a href="#3-通知" class="headerlink" title="3. 通知"></a>3. 通知</h4></blockquote>
<p>实际被增强的逻辑部分称为通知</p>
<ul>
<li>前置通知</li>
<li>后置通知</li>
<li>环绕通知</li>
<li>异常通知</li>
<li>最终通知</li>
</ul>
<blockquote>
<h4 id="4-切面"><a href="#4-切面" class="headerlink" title="4. 切面"></a>4. 切面</h4></blockquote>
<p>是动作、是把通知应用到切入点的过程。</p>
<h2 id="3-5-AOP操作（AspectJ）"><a href="#3-5-AOP操作（AspectJ）" class="headerlink" title="3.5 AOP操作（AspectJ）"></a>3.5 AOP操作（AspectJ）</h2><p>1、创建两个类，增强类和被增强类，创建方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Book....被增强方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;BookProxy...增强方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、在spring配置文件中创建两个类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;book&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.atguigu.spring5.aopxml.Book&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;bookproxy&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.atguigu.spring5.aopxml.BookProxy&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line">&lt;!--配置aop增强--&gt;</span><br><span class="line">&lt;aop:config &gt;</span><br><span class="line">    &lt;!--切入点--&gt;</span><br><span class="line">    &lt;aop:pointcut id=<span class="string">&quot;point&quot;</span> expression=<span class="string">&quot;execution(* com.atguigu.spring5.aopxml.Book.add(..))&quot;</span>/&gt;</span><br><span class="line">    &lt;!--配置切面--&gt;</span><br><span class="line">    &lt;aop:aspect ref=<span class="string">&quot;bookproxy&quot;</span>&gt;</span><br><span class="line">        &lt;!--增强作用在具体的方法上--&gt;</span><br><span class="line">        &lt;aop:before method=<span class="string">&quot;update&quot;</span> pointcut-ref=<span class="string">&quot;point&quot;</span>&gt;&lt;/aop:before&gt;</span><br><span class="line">    &lt;/aop:aspect&gt;</span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904220109966.png" alt="image-20210904220109966"></p>
<h3 id="3-5-1AspectJ注解"><a href="#3-5-1AspectJ注解" class="headerlink" title="3.5.1AspectJ注解"></a>3.5.1AspectJ注解</h3><p>1、创建类，在类里面定义方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add.............1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、创建增强类（编写增强逻辑）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserProxy</span> </span>&#123;</span><br><span class="line">    <span class="comment">//前置通知</span></span><br><span class="line">    <span class="meta">@Before(value = &quot;execution(* com.atguigu.spring5.AopAnno.User.add(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@After(value = &quot;execution(* com.atguigu.spring5.AopAnno.User.add(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-6完全使用注解开发"><a href="#3-6完全使用注解开发" class="headerlink" title="3.6完全使用注解开发"></a>3.6完全使用注解开发</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span><span class="comment">//作为配置类，代替xml文件，开启组件扫描</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &#123;&quot;com.atguigu&quot;&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*生成代理对象*/</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-JdbcTemplate操作数据库"><a href="#4-JdbcTemplate操作数据库" class="headerlink" title="4 JdbcTemplate操作数据库"></a>4 JdbcTemplate操作数据库</h1><h2 id="4-1什么是JdbcTemplate"><a href="#4-1什么是JdbcTemplate" class="headerlink" title="4.1什么是JdbcTemplate"></a>4.1什么是JdbcTemplate</h2><p>Spring框架对JDBC进行封装，使用JdbcTemplate方便实现对数据库操作</p>
<h2 id="4-2准备工作"><a href="#4-2准备工作" class="headerlink" title="4.2准备工作"></a>4.2准备工作</h2><p>（1）引入相关jar包</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904220402259.png" alt="image-20210904220402259" style="zoom:50%;" />

<p>（2）在spring配置文件配置数据库连接池</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;dataSource&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span><br><span class="line">      destroy-method=<span class="string">&quot;close&quot;</span>&gt;</span><br><span class="line">    &lt;!-- 获取properties文件内容，根据key获取，使用spring表达式获取 --&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;driverClassName&quot;</span> value=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;jdbc:mysql://localhost:3306/user_db&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;root&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;lhy147258&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>（3）配置JdbcTemplate对象，注入DataSource</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--JdbcTemplate对象--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span><br><span class="line">    &lt;!--源码Set注入--&gt;</span><br><span class="line">    &lt;!--注入dataSource--&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;dataSource&quot;</span> ref=<span class="string">&quot;dataSource&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line">（<span class="number">4</span>）创建service类，创建dao类，在dao注入jdbcTemplate对象</span><br><span class="line"></span><br><span class="line">		<span class="number">4.1</span>开启组件扫描</span><br><span class="line">		&lt;!--组件扫描--&gt;</span><br><span class="line">&lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.atguigu&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line">		<span class="number">4.2</span>创建service类，创建dao类，在dao注入jdbcTemplate对象</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注入dao</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="comment">//@Autowired 在service中调用dao的方法，首先，创建对象，然后注入属性类型</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDaoImp</span> <span class="keyword">implements</span> <span class="title">BookDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注入Jdbc框架</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-JdbcTemplate操作数据库"><a href="#4-3-JdbcTemplate操作数据库" class="headerlink" title="4.3 JdbcTemplate操作数据库"></a>4.3 JdbcTemplate操作数据库</h2><p>1、对应数据库创建实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String user_id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String ustatus;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Book&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;user_id=&#x27;&quot;</span> + user_id + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, ustatus=&#x27;&quot;</span> + ustatus + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUser_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user_id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUstatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ustatus;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_id</span><span class="params">(String user_id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user_id = user_id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUstatus</span><span class="params">(String ustatus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ustatus = ustatus;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、编写service和dao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注入dao</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="comment">//@Autowired 在service中调用dao的方法，首先，创建对象，然后注入属性类型</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="comment">//添加的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        bookDao.add(book);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//修改的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateBook</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        bookDao.updateBook(book);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteBook</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        bookDao.deleteBook(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询表记录数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findCount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookDao.selectCount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询表记录，返回对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">findOne</span><span class="params">(String id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookDao.findBookInfo(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询返回集合</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookDao.findAllBook();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量添加</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchAdd</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>&#123;</span><br><span class="line">        bookDao.batchAddBook(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量修改</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchUpdate</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>&#123;</span><br><span class="line">        bookDao.batchUpdateBook(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量删除</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchDelete</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>&#123;</span><br><span class="line">        bookDao.batchDeleteBook(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Book book)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateBook</span><span class="params">(Book book)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteBook</span><span class="params">(String id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">selectCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Book <span class="title">findBookInfo</span><span class="params">(String id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Book&gt; <span class="title">findAllBook</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">batchAddBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">batchUpdateBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">batchDeleteBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDaoImp</span> <span class="keyword">implements</span> <span class="title">BookDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注入Jdbc框架</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1创建sql语句</span></span><br><span class="line">        String sql=<span class="string">&quot;insert into t_book values(?,?,?)&quot;</span>;</span><br><span class="line">        Object[] args=&#123;book.getUser_id(),book.getUsername(),book.getUstatus()&#125;;</span><br><span class="line">        <span class="keyword">int</span> update = jdbcTemplate.update(sql,args);</span><br><span class="line">        System.out.println(update);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateBook</span><span class="params">(Book book)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update t_book set username=?,ustatus=? where user_id=?&quot;</span>;</span><br><span class="line">        Object[] args=&#123;book.getUsername(),book.getUstatus(),book.getUser_id()&#125;;</span><br><span class="line">        <span class="keyword">int</span> update1 = jdbcTemplate.update(sql, args);</span><br><span class="line">        System.out.println(update1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteBook</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;delete from t_book where user_id=?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> update2 = jdbcTemplate.update(sql, id);</span><br><span class="line">        System.out.println(update2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">selectCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;select count(*) from t_book&quot;</span>;</span><br><span class="line">        Integer count = jdbcTemplate.queryForObject(sql, Integer.class);</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">findBookInfo</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;select * from t_book where user_id=?&quot;</span>;</span><br><span class="line">        Book book = jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;Book&gt;(Book.class),id);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findAllBook</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;select * from t_book&quot;</span>;</span><br><span class="line">        List&lt;Book&gt; bookList= jdbcTemplate.query(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;Book&gt;(Book.class));</span><br><span class="line">        <span class="keyword">return</span> bookList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchAddBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;insert into t_book values(?,?,?)&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">        System.out.println(Arrays.toString(ints));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchUpdateBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update t_book set username=?,ustatus=? where user_id=?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">        System.out.println(Arrays.toString(ints));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchDeleteBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;delete from t_book where user_id=?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span>[] ints1 = jdbcTemplate.batchUpdate(sql,batchArgs);</span><br><span class="line">        System.out.println(Arrays.toString(ints1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">testbook</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJdbcTemplate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context1 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context1.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        Book book=<span class="keyword">new</span> Book();</span><br><span class="line">        book.setUser_id(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        book.setUsername(<span class="string">&quot;刘&quot;</span>);</span><br><span class="line">        book.setUstatus(<span class="string">&quot;滕州&quot;</span>);</span><br><span class="line">        bookService.addBook(book);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context2 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context2.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        Book book=<span class="keyword">new</span> Book();</span><br><span class="line">        book.setUser_id(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        book.setUsername(<span class="string">&quot;王&quot;</span>);</span><br><span class="line">        book.setUstatus(<span class="string">&quot;哈尔滨&quot;</span>);</span><br><span class="line">        bookService.updateBook(book);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context3 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context3.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        Book book=<span class="keyword">new</span> Book();</span><br><span class="line">        bookService.deleteBook(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context4 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context4.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        <span class="keyword">int</span> count = bookService.findCount();</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询返回对象</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context5 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context5.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        Book one = bookService.findOne(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        System.out.println(one);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询返回集合</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context9 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context9.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        List&lt;Book&gt; all = bookService.findAll();</span><br><span class="line">        System.out.println(all);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量添加</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context5 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context5.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        Object[] o1=&#123;<span class="string">&quot;3&quot;</span>,<span class="string">&quot;java&quot;</span>,<span class="string">&quot;a&quot;</span>&#125;;</span><br><span class="line">        Object[] o2=&#123;<span class="string">&quot;1&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;v&quot;</span>&#125;;</span><br><span class="line">        Object[] o3=&#123;<span class="string">&quot;2&quot;</span>,<span class="string">&quot;php&quot;</span>,<span class="string">&quot;m&quot;</span>&#125;;</span><br><span class="line">        batchArgs.add(o1);</span><br><span class="line">        batchArgs.add(o2);</span><br><span class="line">        batchArgs.add(o3);</span><br><span class="line">        bookService.batchAdd(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量修改</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context6 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context6.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        Object[] o1=&#123;<span class="string">&quot;java++0909&quot;</span>,<span class="string">&quot;tt&quot;</span>,<span class="string">&quot;3&quot;</span>,&#125;;</span><br><span class="line">        Object[] o2=&#123;<span class="string">&quot;c1010&quot;</span>,<span class="string">&quot;bb&quot;</span>,<span class="string">&quot;1&quot;</span>&#125;;</span><br><span class="line">        Object[] o3=&#123;<span class="string">&quot;phpkjljk&quot;</span>,<span class="string">&quot;zz&quot;</span>,<span class="string">&quot;2&quot;</span>&#125;;</span><br><span class="line">        batchArgs.add(o1);</span><br><span class="line">        batchArgs.add(o2);</span><br><span class="line">        batchArgs.add(o3);</span><br><span class="line">        bookService.batchUpdate(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//批量删除</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ClassPathXmlApplicationContext context8 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        BookService bookService = context8.getBean(<span class="string">&quot;bookService&quot;</span>, BookService.class);</span><br><span class="line">        List&lt;Object[]&gt; batchArgs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        Object[] o1=&#123;<span class="string">&quot;3&quot;</span>,&#125;;</span><br><span class="line">        Object[] o2=&#123;<span class="string">&quot;1&quot;</span>&#125;;</span><br><span class="line">        batchArgs.add(o1);</span><br><span class="line">        batchArgs.add(o2);</span><br><span class="line">        bookService.batchDelete(batchArgs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-事务操作"><a href="#5-事务操作" class="headerlink" title="5 事务操作"></a>5 事务操作</h1><h2 id="5-1事务概念"><a href="#5-1事务概念" class="headerlink" title="5.1事务概念"></a>5.1事务概念</h2><p>1、什么事务<br>（1）事务是数据库操作最基本单元，逻辑上一组操作，要么都成功，如果有一个失败所有操作都失败<br>（2）典型场景：银行转账</p>
<ul>
<li>lucy转账100元给mary</li>
<li>lucy少100，mary多100</li>
</ul>
<p>2、事务四个特性（ACID）<br>（1）原子性(要么都成功，要么都失败)<br>（2）一致性（200）<br>（3）隔离性（不会产生影响）<br>（4）持久性（表中数据会产生变化）</p>
<h2 id="5-2事务操作（搭建事务操作环境）"><a href="#5-2事务操作（搭建事务操作环境）" class="headerlink" title="5.2事务操作（搭建事务操作环境）"></a>5.2事务操作（搭建事务操作环境）</h2><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221040456.png" alt="image-20210904221040456" style="zoom:67%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//lucy转账100给mary</span></span><br><span class="line">    <span class="comment">//多钱</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update t_account set money=money+? where username=?&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql, <span class="number">100</span>, <span class="string">&quot;mary&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//少钱</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduceMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql=<span class="string">&quot;update t_account set money=money-? where username=?&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql,<span class="number">100</span>,<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//转账的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accountMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">//lucy少100</span></span><br><span class="line">            userDao.reduceMoney();</span><br><span class="line">            <span class="comment">//mary多100</span></span><br><span class="line">            userDao.addMoney();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBook</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testaccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ClassPathXmlApplicationContext context1 = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        UserService userService = context1.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">        userService.accountMoney();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3、上面代码，如果正常执行没有问题的，但是如果代码执行过程中出现异常，有问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class UserService &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private UserDao userDao;</span><br><span class="line"></span><br><span class="line">    //转账的方法</span><br><span class="line">    public void accountMoney() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            //第一步 开启事务</span><br><span class="line">            //第二步 进行业务操作</span><br><span class="line">            //lucy少100</span><br><span class="line">            userDao.reduceMoney();</span><br><span class="line"></span><br><span class="line">            //模拟异常</span><br><span class="line">            int i=10/0;</span><br><span class="line"></span><br><span class="line">            //mary多100</span><br><span class="line">            userDao.addMoney();</span><br><span class="line">            //第步 没发生异常，提交事务</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            //第四步 出现异常，事务回滚</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-3事务操作（Spring事务管理介绍）"><a href="#5-3事务操作（Spring事务管理介绍）" class="headerlink" title="5.3事务操作（Spring事务管理介绍）"></a>5.3事务操作（Spring事务管理介绍）</h2><p>1、事务添加到JavaEE三层结构里面Service层（业务逻辑层）<br>2、在Spring进行事务管理操作<br>（1）有两种方式：编程式事务管理和声明式事务管理（使用）<br>3、声明式事务管理<br>（1）基于注解方式（使用）<br>（2）基于xml配置文件方式<br>4、在Spring进行声明式事务管理，底层使用AOP原理<br>5、Spring事务管理API<br>（1）提供一个接口，代表事务管理器，这个接口针对不同的框架提供不同的实现类</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221202810.png" alt="image-20210904221202810" style="zoom: 80%;" />



<h2 id="5-4事务操作（注解声明式事务管理）"><a href="#5-4事务操作（注解声明式事务管理）" class="headerlink" title="5.4事务操作（注解声明式事务管理）"></a>5.4事务操作（注解声明式事务管理）</h2><p>1、在spring配置文件配置事务管理器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--创建事务管理器--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;TransactionManager&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;dataSource&quot;</span> ref=<span class="string">&quot;dataSource&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>2、在spring配置文件，开启事务注解<br>（1）在spring配置文件引入名称空间tx</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xmlns:aop=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="line">       xmlns:tx=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/aop</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/tx</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>   (2)开启事务注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--开启事务注解--&gt;</span><br><span class="line">&lt;tx:annotation-driven transaction-manager=<span class="string">&quot;TransactionManager&quot;</span>&gt;&lt;/tx:annotation-driven&gt;</span><br></pre></td></tr></table></figure>

<p>3、在Service类上面（或者Service类里面方法上面）添加事务注解（出现问题，不会多也不会少）<br>（1）@Transactional，这个注解添加到类上面，也可以添加方法上面<br>（2）如果把这个注解添加类上面，这个类里面所有的方法都添加事务<br>（3）如果把这个注解添加方法上面，为这个方法添加事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="comment">//转账的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accountMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//第一步 开启事务</span></span><br><span class="line">            <span class="comment">//第二步 进行业务操作</span></span><br><span class="line">            <span class="comment">//lucy少100</span></span><br><span class="line">            userDao.reduceMoney();</span><br><span class="line">            <span class="comment">//模拟异常</span></span><br><span class="line">            <span class="keyword">int</span> i=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">            <span class="comment">//mary多100</span></span><br><span class="line">            userDao.addMoney();</span><br><span class="line">            <span class="comment">//第步 没发生异常，提交事务</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//第四步 出现异常，事务回滚</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-5事务操作（声明式事务管理参数配置）"><a href="#5-5事务操作（声明式事务管理参数配置）" class="headerlink" title="5.5事务操作（声明式事务管理参数配置）"></a>5.5事务操作（声明式事务管理参数配置）</h2><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221410213.png" alt="image-20210904221410213" style="zoom:80%;" />

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221418972.png" alt="image-20210904221418972" style="zoom:80%;" />

<p>3、ioslation：事务隔离级别<br>（1）事务有特性成为隔离性，多事务操作之间不会产生影响。不考虑隔离性产生很多问题<br>（2）有三个读问题：脏读、不可重复读、虚（幻）读<br>（3）脏读：一个未提交事务读取到另一个未提交事务的数据</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221534776.png" alt="image-20210904221534776" style="zoom: 67%;" />

<p>（4）不可重复读：一个未提交事务读取到另一提交事务修改数据</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904223402317.png" alt="image-20210904223402317" style="zoom:80%;" />

<p>（5）虚读：一个未提交事务读取到另一提交事务添加数据<br>（6）解决：通过设置事务隔离级别，解决读问题</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904223428153.png" alt="image-20210904223428153" style="zoom:67%;" />

<p>4、timeout：超时时间<br>（1）事务需要在一定时间内进行提交，如果不提交进行回滚<br>（2）默认值是-1，设置时间以秒单位进行计算<br>5、readOnly：是否只读<br>（1）读：查询操作，写：添加修改删除操作<br>（2）readOnly默认值false，表示可以查询，可以添加修改删除操作<br>（3）设置readOnly值是true，设置成true之后，只能查询<br>6、rollbackFor：回滚<br>（1）设置出现哪些异常进行事务回滚<br>7、noRollbackFor：不回滚<br>（1）设置出现哪些异常不进行事务回滚</p>
<h2 id="5-6事务操作（XML声明式事务管理）"><a href="#5-6事务操作（XML声明式事务管理）" class="headerlink" title="5.6事务操作（XML声明式事务管理）"></a>5.6事务操作（XML声明式事务管理）</h2><p>1、在spring配置文件中进行配置<br>    第一步配置事务管理器<br>    第二步配置通知<br>    第三步配置切入点和切面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="number">1</span> 创建事务管理器--&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;transactionManager&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class="line">    &lt;property name=<span class="string">&quot;dataSource&quot;</span> ref=<span class="string">&quot;dataSource&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line">&lt;!--<span class="number">2</span> 配置通知--&gt;</span><br><span class="line">&lt;tx:advice id=<span class="string">&quot;txadvice&quot;</span>&gt;</span><br><span class="line">    &lt;!--配置事务参数--&gt;</span><br><span class="line">        &lt;tx:attributes&gt;</span><br><span class="line">            &lt;!--指定哪种规则的方法上添加事务<span class="number">9</span>--&gt;</span><br><span class="line">            &lt;tx:method name=<span class="string">&quot;accountMoney&quot;</span>/&gt;</span><br><span class="line">            &lt;tx:method name=<span class="string">&quot;account*&quot;</span> /&gt;</span><br><span class="line">        &lt;/tx:attributes&gt;</span><br><span class="line">&lt;/tx:advice&gt;</span><br><span class="line">&lt;!--配置切入点和切面--&gt;</span><br><span class="line">&lt;aop:config&gt;</span><br><span class="line">    &lt;aop:pointcut id=<span class="string">&quot;pt&quot;</span> expression=<span class="string">&quot;execution(* com.atguigu.spring5.service.UserService.*(..))&quot;</span>/&gt;</span><br><span class="line">    &lt;!--配置切面--&gt;</span><br><span class="line">    &lt;aop:advisor advice-ref=<span class="string">&quot;txadvice&quot;</span> pointcut-ref=<span class="string">&quot;pt&quot;</span>/&gt;</span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-7事务操作（完全注解声明式事务管理）"><a href="#5-7事务操作（完全注解声明式事务管理）" class="headerlink" title="5.7事务操作（完全注解声明式事务管理）"></a>5.7事务操作（完全注解声明式事务管理）</h2><p>1、创建配置类，使用配置类替代xml配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//配置类</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &quot;com.atguigu&quot;)</span> <span class="comment">//组件扫描</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span><span class="comment">//开启事务</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TxConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建数据库的连接池</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">getDruidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/user_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;lhy147258&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建jdbcTemplate对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JdbcTemplate <span class="title">getJdbcTemplate</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//到ioc容器中根据类型找到dataSource</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate();</span><br><span class="line">        <span class="comment">//注入dataSource</span></span><br><span class="line">        jdbcTemplate.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建事务管理器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceTransactionManager <span class="title">getdataSourceTransactionManager</span><span class="params">(DataSource dataSource)</span></span>&#123;</span><br><span class="line">        DataSourceTransactionManager transactionManager = <span class="keyword">new</span> DataSourceTransactionManager();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation =  Propagation.REQUIRED,isolation =Isolation.REPEATABLE_READ)</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//转账的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accountMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//try &#123;</span></span><br><span class="line">            <span class="comment">//第一步 开启事务</span></span><br><span class="line">            <span class="comment">//第二步 进行业务操作</span></span><br><span class="line">            <span class="comment">//lucy少100</span></span><br><span class="line">            userDao.reduceMoney();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//模拟异常</span></span><br><span class="line">            <span class="keyword">int</span> i=<span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//mary多100</span></span><br><span class="line">            userDao.addMoney();</span><br><span class="line">            <span class="comment">//第步 没发生异常，提交事务</span></span><br><span class="line">        <span class="comment">//&#125; catch (Exception e) &#123;</span></span><br><span class="line">            <span class="comment">//第四步 出现异常，事务回滚</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testaccount2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    AnnotationConfigApplicationContext context3 = <span class="keyword">new</span> AnnotationConfigApplicationContext(TxConfig.class);</span><br><span class="line">    UserService userService = context3.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.accountMoney();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-Webflux"><a href="#6-Webflux" class="headerlink" title="6 Webflux"></a>6 Webflux</h1><h2 id="6-1-Spring5框架新功能"><a href="#6-1-Spring5框架新功能" class="headerlink" title="6.1 Spring5框架新功能"></a>6.1 Spring5框架新功能</h2><p>1、整个Spring5框架的代码基于Java8，运行时兼容JDK9，许多不建议使用的类和方法在代码库中删除<br>2、Spring 5.0框架自带了通用的日志封装<br>    （1）Spring5已经移除Log4jConfigListener，官方建议使用Log4j2<br>    （2）Spring5框架整合Log4j2<br>第一步引入jar包</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905093313520.png" alt="image-20210905093313520" style="zoom:80%;" />

<p>第二步创建log4j2.xml配置文件</p>
<p>3、Spring5框架核心容器支持@Nullable注解<br>    （1）@Nullable注解可以使用在方法上面，属性上面，参数上面，表示方法返回可以为空，属性值可以为空，参数值可以为空<br>    （2）注解用在方法上面，方法返回值可以为空<br>    （3）注解使用在方法参数里面，方法参数可以为空<br>    （4）注解使用在属性上面，属性值可以为空<br>  4、Spring5核心容器支持函数式风格GenericApplicationContext</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGenericApplicationContext</span><span class="params">()</span></span>&#123;</span><br><span class="line">    GenericApplicationContext context4 = <span class="keyword">new</span> GenericApplicationContext();</span><br><span class="line">    context4.refresh();</span><br><span class="line">    context4.registerBean(User.class,()-&gt;<span class="keyword">new</span> User());</span><br><span class="line">    User user = (User)context4.getBean(<span class="string">&quot;com.atguigu.spring5.test.User&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-Spring5支持整合JUnit5"><a href="#6-2-Spring5支持整合JUnit5" class="headerlink" title="6.2 Spring5支持整合JUnit5"></a>6.2 Spring5支持整合JUnit5</h2><p>（1）整合JUnit4</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span><span class="comment">//单元测试框架</span></span><br><span class="line"><span class="meta">@ContextConfiguration(&quot;classpath:bean1.xml&quot;)</span><span class="comment">//加载配置文件</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTest4</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userService.accountMoney();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（2）Spring5整合JUnit5第一步引入JUnit5的jar包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ExtendWith(SpringExtension.class)</span></span><br><span class="line"><span class="comment">//@ContextConfiguration(&quot;classpath:bean1.xml&quot;)</span></span><br><span class="line"><span class="meta">@SpringJUnitConfig(locations = &quot;classpath:bean1.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JTest5</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userService.accountMoney();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3-Spring5框架新功能（Webflux）-响应式编程"><a href="#6-3-Spring5框架新功能（Webflux）-响应式编程" class="headerlink" title="6.3 Spring5框架新功能（Webflux）-响应式编程"></a>6.3 Spring5框架新功能（Webflux）-响应式编程</h2><p>1、SpringWebflux介绍<br>（1）是Spring5添加新的模块，用于web开发的，功能和SpringMVC类似的，Webflux使用当前一种比较流程响应式编程出现的框架。</p>
<p><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101300816.png" alt="image-20210905101300816"></p>
<p>（2）使用传统web框架，比如SpringMVC，这些基于Servlet容器，Webflux是一种异步非阻塞的框架，异步非阻塞的框架在Servlet3.1以后才支持，核心是基于Reactor的相关API实现的。<br>（3）解释什么是异步非阻塞<br>    *异步和同步<br>    *非阻塞和阻塞<br>    上面都是针对对象不一样<br>**异步和同步针对调用者，调用者发送请求，如果等着对方回应之后才去做其他事情就是同步，如果发送请求之后不等着对方回应就去做其他事情就是异步<br>**阻塞和非阻塞针对被调用者，被调用者受到请求之后，做完请求任务之后才给出反馈就是阻塞，受到请求之后马上给出反馈然后再去做事情就是非阻塞<br>（4）Webflux特点：<br>第一非阻塞式：在有限资源下，提高系统吞吐量和伸缩性，以Reactor为基础实现响应式编程<br>第二函数式编程：Spring5框架基于java8，Webflux使用Java8函数式编程方式实现路由请求<br>（5）比较SpringMVC</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101333117.png" alt="image-20210905101333117" style="zoom:80%;" />

<p>第一两个框架都可以使用注解方式，都运行在Tomet等容器中<br>第二SpringMVC采用命令式编程，Webflux采用异步响应式编程<br>2、响应式编程（Java实现）<br>（1）什么是响应式编程<br>响应式编程是一种面向数据流和变化传播的编程范式。这意味着可以在编程语言中很方便地表达静态或动态的数据流，而相关的计算模型会自动将变化的值通过数据流进行传播。电子表格程序就是响应式编程的一个例子。单元格可以包含字面值或类似”=B1+C1”的公式，而包含公式的单元格的值会依据其他单元格的值的变化而变化。<br>（2）Java8及其之前版本<br>*提供的观察者模式两个类Observer和Observable</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverDemo</span> <span class="keyword">extends</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ObserverDemo observer = <span class="keyword">new</span> ObserverDemo();</span><br><span class="line">        <span class="comment">//添加观察者</span></span><br><span class="line">        observer.addObserver((o,arg)-&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;发生了变化&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        observer.addObserver((o,arg)-&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;手动被观察者通知，准备改变&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        observer.setChanged();<span class="comment">//数据变化</span></span><br><span class="line">        observer.notifyObservers();<span class="comment">//通知</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、响应式编程（Reactor实现）<br>（1）响应式编程操作中，Reactor是满足Reactive规范框架<br>（2）Reactor有两个核心类，Mono和Flux，这两个类实现接口Publisher，提供丰富操作符。Flux对象实现发布者，返回N个元素；Mono实现发布者，返回0或者1个元素<br>（3）Flux和Mono都是数据流的发布者，使用Flux和Mono都可以发出三种数据信号：元素值，错误信号，完成信号，错误信号和完成信号都代表终止信号，终止信号用于告诉订阅者数据流结束了，错误信号终止数据流同时把错误信息传递给订阅者</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101413136.png" alt="image-20210905101413136" style="zoom:67%;" />

<p>（4）代码演示Flux和Mono</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">testReactor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//just方法直接声明</span></span><br><span class="line">        Flux.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">        Mono.just(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//其他的方法</span></span><br><span class="line">        Integer[] array=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">        Flux.fromArray(array);</span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; list = Arrays.asList(array);</span><br><span class="line">        Flux.fromIterable(list);</span><br><span class="line"></span><br><span class="line">        Stream&lt;Integer&gt; stream = list.stream();</span><br><span class="line">        Flux.fromStream(stream);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（5）三种信号特点<br>*错误信号和完成信号都是终止信号，不能共存的<br>*如果没有发送任何元素值，而是直接发送错误或者完成信号，表示是空数据流<br>*如果没有错误信号，没有完成信号，表示是无限数据流<br>（6）调用just或者其他方法只是声明数据流，数据流并没有发出，只有进行订阅之后才会触发数据流，不订阅什么都不会发生的<br>        Flux.just(1,2,3,4).subscribe(System.out::print);<br>        Mono.just(1).subscribe(System.out::print);<br>（7）操作符<br>*对数据流进行一道道操作，成为操作符，比如工厂流水线<br>第一map元素映射为新元素</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101447194.png" alt="image-20210905101447194" style="zoom:67%;" />

<p>第二flatMap元素映射为流</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101503336.png" alt="image-20210905101503336" style="zoom:80%;" />

<p>把每个元素转换流，把转换之后多个流合并大的流<br>4、SpringWebflux执行流程和核心API<br>SpringWebflux基于Reactor，默认使用容器是Netty，Netty是高性能的NIO（异步非阻塞）框架，异步非阻塞的框架<br>（1）Netty<br> BIO（阻塞）</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101525119.png" alt="image-20210905101525119" style="zoom:67%;" />

<p>NIO（多路复用）</p>
<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101540343.png" alt="image-20210905101540343" style="zoom:80%;" />

<p>（2）SpringWebflux执行过程和SpringMVC相似的</p>
<ul>
<li>SpringWebflux核心控制器DispatchHandler，实现接口WebHandler<br>接口WebHandler有一个方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WebHandler</span> </span>&#123;</span><br><span class="line">    <span class="function">Mono&lt;Void&gt; <span class="title">handle</span><span class="params">(ServerWebExchange var1)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">handle</span><span class="params">(ServerWebExchange exchange)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.handlerMappings == <span class="keyword">null</span> ? <span class="keyword">this</span>.createNotFoundError() : Flux.fromIterable(<span class="keyword">this</span>.handlerMappings).concatMap((mapping) -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> mapping.getHandler(exchange);</span><br><span class="line">    &#125;).next().switchIfEmpty(<span class="keyword">this</span>.createNotFoundError()).flatMap((handler) -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.invokeHandler(exchange, handler);</span><br><span class="line">    &#125;).flatMap((result) -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.handleResult(exchange, result);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210905101616690.png" alt="image-20210905101616690" style="zoom:80%;" />

<p>（3）SpringWebflux里面DispatcherHandler，负责请求的处理</p>
<ul>
<li>HandlerMapping：请求查询到处理的方法</li>
<li>HandlerAdapter：真正负责请求处理</li>
<li>HandlerResultHandler：响应结果处理</li>
</ul>
<p>（4）SpringWebflux实现函数式编程，两个接口：RouterFunction（路由处理）和HandlerFunction（处理函数）</p>
<h2 id="6-4SpringWebflux（基于注解编程模型）"><a href="#6-4SpringWebflux（基于注解编程模型）" class="headerlink" title="6.4SpringWebflux（基于注解编程模型）"></a>6.4SpringWebflux（基于注解编程模型）</h2><p>SpringWebflux实现方式有两种：注解编程模型和函数式编程模型<br>使用注解编程模型方式，和之前SpringMVC使用相似的，只需要把相关依赖配置到项目中，SpringBoot自动配置相关运行容器，默认情况下使用Netty服务器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*public User() &#123;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, String gender, Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用户操作接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//根据id查询用户</span></span><br><span class="line">    <span class="function">Mono&lt;User&gt; <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">//查询所用户</span></span><br><span class="line">    <span class="function">Flux&lt;User&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//添加用户</span></span><br><span class="line">    <span class="function">Mono&lt;Void&gt; <span class="title">saveUserInfo</span><span class="params">(Mono&lt;User&gt; user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建map集合存储数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;Integer,User&gt; users=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserServiceImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users.put(<span class="number">1</span>,<span class="keyword">new</span> User(<span class="string">&quot;lucy&quot;</span>,<span class="string">&quot;man&quot;</span>,<span class="number">20</span>));</span><br><span class="line">        <span class="keyword">this</span>.users.put(<span class="number">2</span>,<span class="keyword">new</span> User(<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;woman&quot;</span>,<span class="number">30</span>));</span><br><span class="line">        <span class="keyword">this</span>.users.put(<span class="number">3</span>,<span class="keyword">new</span> User(<span class="string">&quot;Jim&quot;</span>,<span class="string">&quot;man&quot;</span>,<span class="number">35</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据ID查询</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;User&gt; <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.justOrEmpty(<span class="keyword">this</span>.users.get(id));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询多个用户</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Flux&lt;User&gt; <span class="title">getAllUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.fromIterable(<span class="keyword">this</span>.users.values());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加用户</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">saveUserInfo</span><span class="params">(Mono&lt;User&gt; userMono)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMono.doOnNext(person-&gt;&#123;</span><br><span class="line">            <span class="comment">//向map集合里面放值</span></span><br><span class="line">            <span class="keyword">int</span> id=users.size()+<span class="number">1</span>;</span><br><span class="line">            users.put(id,person);<span class="comment">//把Mono放到一个对象</span></span><br><span class="line">        &#125;).thenEmpty(Mono.empty());<span class="comment">//终止信号</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注入service</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//id查询</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;User&gt; <span class="title">getUserId</span><span class="params">(<span class="meta">@PathVariable</span> <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查询所</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Flux&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getAllUser();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveuser&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">saveUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">        Mono&lt;User&gt; userMono=Mono.just(user);</span><br><span class="line">        <span class="keyword">return</span> userService.saveUserInfo(userMono);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>SpringMVC方式实现，</p>
<ul>
<li>同步阻塞的方式，基于SpringMVC+Servlet+TomcatSpringWebflux方式实现</li>
<li>异步非阻塞方式，基于SpringWebflux+Reactor+Netty</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">刘恒运</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/07/31/Spring/">http://example.com/2021/07/31/Spring/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">luckforever</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/IOC/">IOC</a><a class="post-meta__tags" href="/tags/AOP/">AOP</a><a class="post-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C/">事务操作</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/liu-hengyun/lhy/raw/master/images/spring/image-20210904221506360.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/08/01/Spring%E9%9D%A2%E8%AF%95%E9%A2%98%20-%20%E7%BD%91%E7%BB%9C/"><img class="prev-cover" src="https://gitee.com/liu-hengyun/lhy/raw/master/images/Spring%E9%9D%A2%E8%AF%95/image-20210909092240317.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Spring面试题</div></div></a></div><div class="next-post pull-right"><a href="/2021/07/30/java%E5%90%84%E7%A7%8D%E9%94%81%20-%20%E7%BD%91%E7%BB%9C/"><img class="next-cover" src="https://gitee.com/liu-hengyun/lhy/raw/master/images/java%E5%90%84%E7%A7%8D%E9%94%81/image-20210727084424434.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JAVA锁</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/个人照片/刘恒运.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">刘恒运</div><div class="author-info__description">学习录</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">61</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">不求事事如人意，但求无愧于我心！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Spring%E6%A1%86%E6%9E%B6%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1. Spring框架概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AFSpring%E6%A1%86%E6%9E%B6%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 什么是Spring框架？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Spring%E6%A1%86%E6%9E%B6%E6%9C%89%E5%93%AA%E4%BA%9B%E7%89%B9%E7%82%B9%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Spring框架有哪些特点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-Spring%E5%85%A5%E9%97%A8"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 Spring入门</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-IOC%E5%AE%B9%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">2 IOC容器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E6%A6%82%E5%BF%B5%E5%92%8C%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 概念和底层原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E4%BB%80%E4%B9%88%E6%98%AFIOC%EF%BC%9F"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 什么是IOC？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-IOC%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 IOC底层原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-IOC%E8%BF%87%E7%A8%8B"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 IOC过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-IOC%E5%AE%B9%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 IOC容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-IOC%E7%9A%84%E5%85%B7%E4%BD%93%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 IOC的具体操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E5%9F%BA%E4%BA%8EXml%E6%96%B9%E5%BC%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 基于Xml方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-1-P%E5%90%8D%E7%A7%B0%E7%A9%BA%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">2.3.1.1 P名称空间注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-2-%E6%B3%A8%E5%85%A5%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">2.3.1.2 注入其他类型属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-3%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7%E9%9B%86%E5%90%88"><span class="toc-number">2.3.1.3.</span> <span class="toc-text">2.3.1.3注入属性集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-4-FactoryBean"><span class="toc-number">2.3.1.4.</span> <span class="toc-text">2.3.1.4 FactoryBean</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-5-bean%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.3.1.5.</span> <span class="toc-text">2.3.1.5  bean作用域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-6-bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.3.1.6.</span> <span class="toc-text">2.3.1.6 bean的生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-7-XML%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D1"><span class="toc-number">2.3.1.7.</span> <span class="toc-text">2.3.1.7  XML自动装配1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-8-XML%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D2"><span class="toc-number">2.3.1.8.</span> <span class="toc-text">2.3.1.8  XML自动装配2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-9-%E5%A4%96%E9%83%A8%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.1.9.</span> <span class="toc-text">2.3.1.9  外部属性文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 基于注解方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-1-%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">2.3.2.1 基于注解方式实现对象创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-2-%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">2.3.2.2 基于注解方式实现属性注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-3-%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">2.3.2.3 完全注解开发</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">2.4  依赖注入的几种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-Autowire%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 @Autowire底层原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-bean%E7%9A%84%E5%90%8D%E5%AD%97"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 bean的名字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-Spring%E8%A7%A3%E5%86%B3%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 Spring解决循环依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring%E5%AE%B9%E5%99%A8%E7%9A%84%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">2.7.0.1.</span> <span class="toc-text">Spring容器的三级缓存</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-Configuation%E6%80%BB%E7%BB%93"><span class="toc-number">2.8.</span> <span class="toc-text">2.8@Configuation总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-AOP"><span class="toc-number">3.</span> <span class="toc-text">3 AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E4%BB%80%E4%B9%88%E6%98%AFAOP"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 什么是AOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-AOP%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 AOP底层原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%9C%89%E6%8E%A5%E5%8F%A3%E6%83%85%E5%86%B5%EF%BC%8C%E4%BD%BF%E7%94%A8JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.2.0.1.</span> <span class="toc-text">第一种有接口情况，使用JDK动态代理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%B2%A1%E6%9C%89%E6%8E%A5%E5%8F%A3%E6%83%85%E5%86%B5%EF%BC%8C%E4%BD%BF%E7%94%A8CGLIB%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.2.0.2.</span> <span class="toc-text">第二种没有接口情况，使用CGLIB动态代理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 JDK动态代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-AOP%E6%9C%AF%E8%AF%AD"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 AOP术语</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BF%9E%E6%8E%A5%E7%82%B9"><span class="toc-number">3.4.0.1.</span> <span class="toc-text">1. 连接点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">3.4.0.2.</span> <span class="toc-text">2. 切入点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%80%9A%E7%9F%A5"><span class="toc-number">3.4.0.3.</span> <span class="toc-text">3. 通知</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%87%E9%9D%A2"><span class="toc-number">3.4.0.4.</span> <span class="toc-text">4. 切面</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-AOP%E6%93%8D%E4%BD%9C%EF%BC%88AspectJ%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">3.5 AOP操作（AspectJ）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-1AspectJ%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.5.1.</span> <span class="toc-text">3.5.1AspectJ注解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6%E5%AE%8C%E5%85%A8%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">3.6.</span> <span class="toc-text">3.6完全使用注解开发</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-JdbcTemplate%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.</span> <span class="toc-text">4 JdbcTemplate操作数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E4%BB%80%E4%B9%88%E6%98%AFJdbcTemplate"><span class="toc-number">4.1.</span> <span class="toc-text">4.1什么是JdbcTemplate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">4.2准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-JdbcTemplate%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 JdbcTemplate操作数据库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">5 事务操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1%E4%BA%8B%E5%8A%A1%E6%A6%82%E5%BF%B5"><span class="toc-number">5.1.</span> <span class="toc-text">5.1事务概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88%E6%90%AD%E5%BB%BA%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%E7%8E%AF%E5%A2%83%EF%BC%89"><span class="toc-number">5.2.</span> <span class="toc-text">5.2事务操作（搭建事务操作环境）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88Spring%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E4%BB%8B%E7%BB%8D%EF%BC%89"><span class="toc-number">5.3.</span> <span class="toc-text">5.3事务操作（Spring事务管理介绍）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88%E6%B3%A8%E8%A7%A3%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%89"><span class="toc-number">5.4.</span> <span class="toc-text">5.4事务操作（注解声明式事务管理）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="toc-number">5.5.</span> <span class="toc-text">5.5事务操作（声明式事务管理参数配置）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88XML%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%89"><span class="toc-number">5.6.</span> <span class="toc-text">5.6事务操作（XML声明式事务管理）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%EF%BC%88%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%89"><span class="toc-number">5.7.</span> <span class="toc-text">5.7事务操作（完全注解声明式事务管理）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Webflux"><span class="toc-number">6.</span> <span class="toc-text">6 Webflux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-Spring5%E6%A1%86%E6%9E%B6%E6%96%B0%E5%8A%9F%E8%83%BD"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 Spring5框架新功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-Spring5%E6%94%AF%E6%8C%81%E6%95%B4%E5%90%88JUnit5"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 Spring5支持整合JUnit5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-Spring5%E6%A1%86%E6%9E%B6%E6%96%B0%E5%8A%9F%E8%83%BD%EF%BC%88Webflux%EF%BC%89-%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 Spring5框架新功能（Webflux）-响应式编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4SpringWebflux%EF%BC%88%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">6.4SpringWebflux（基于注解编程模型）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/07/SpringMVC%E9%9D%A2%E8%AF%95%E9%A2%98%20-%20%E7%BD%91%E7%BB%9C/" title="SpringMVC面试"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/springmvc/image-20210905105137663.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringMVC面试"/></a><div class="content"><a class="title" href="/2021/08/07/SpringMVC%E9%9D%A2%E8%AF%95%E9%A2%98%20-%20%E7%BD%91%E7%BB%9C/" title="SpringMVC面试">SpringMVC面试</a><time datetime="2021-08-07T09:00:00.000Z" title="发表于 2021-08-07 17:00:00">2021-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/07/SpringMVC-%E7%BD%91%E7%BB%9C/" title="SpringMVC"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/springmvc/image-20210905125144476.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringMVC"/></a><div class="content"><a class="title" href="/2021/08/07/SpringMVC-%E7%BD%91%E7%BB%9C/" title="SpringMVC">SpringMVC</a><time datetime="2021-08-07T05:00:00.000Z" title="发表于 2021-08-07 13:00:00">2021-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/mybatis%20-%20%E7%BD%91%E7%BB%9C/" title="Mybatis"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/mybatis/1569633932712.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mybatis"/></a><div class="content"><a class="title" href="/2021/08/05/mybatis%20-%20%E7%BD%91%E7%BB%9C/" title="Mybatis">Mybatis</a><time datetime="2021-08-05T02:00:00.000Z" title="发表于 2021-08-05 10:00:00">2021-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/02/MyBatis%E9%9D%A2%E8%AF%95%E9%A2%98%20-%20%E5%89%AF%E6%9C%AC/" title="MyBatis面试题"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/mybatis%E9%9D%A2%E8%AF%95%E9%A2%98/1569660357745.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MyBatis面试题"/></a><div class="content"><a class="title" href="/2021/08/02/MyBatis%E9%9D%A2%E8%AF%95%E9%A2%98%20-%20%E5%89%AF%E6%9C%AC/" title="MyBatis面试题">MyBatis面试题</a><time datetime="2021-08-02T09:00:00.000Z" title="发表于 2021-08-02 17:00:00">2021-08-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/Spring%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20-%20%E7%BD%91%E7%BB%9C/" title="Spring源码分析"><img src="https://gitee.com/liu-hengyun/lhy/raw/master/images/Spring%E9%9D%A2%E8%AF%95/spring-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring源码分析"/></a><div class="content"><a class="title" href="/2021/08/01/Spring%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20-%20%E7%BD%91%E7%BB%9C/" title="Spring源码分析">Spring源码分析</a><time datetime="2021-08-01T09:00:00.000Z" title="发表于 2021-08-01 17:00:00">2021-08-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 刘恒运</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>